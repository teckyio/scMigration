SELECT 'MATERIAL' AS "TABLE_NAME",
       (SELECT COUNT(MATERIALS) FROM SDE_SQ.SQUATTERMATERIAL) AS "TOTAL",
       (
           (SELECT COUNT(m.NAME) 
            FROM SQ.MATERIALS m 
            JOIN SQ.SQUATTER_MATERIALS sm ON m.ID = sm.MATERIAL_ID 
            WHERE sm.OBJECT_ID IS NOT NULL 
              AND sm.OBJECT_ID IN (SELECT OBJECTID FROM SDE_SQ.SQUATTERMATERIAL))
           +
           (SELECT COUNT(m.NAME) 
            FROM SQ.MATERIALS m 
            JOIN SQ.SQUATTER_MATERIAL_HIS sm ON m.ID = sm.MATERIAL_ID 
            WHERE sm.OBJECT_ID IS NOT NULL 
              AND sm.OBJECT_ID IN (SELECT OBJECTID FROM SDE_SQ.SQUATTERMATERIAL_HIS))
       ) AS "SUCCESS"
FROM DUAL
UNION ALL
SELECT 'USE' AS "TABLE_NAME",
       (SELECT COUNT(SQUATTERUSE) FROM SDE_SQ.SQUATTERUSE) AS "TOTAL",
       (
           (SELECT COUNT(u.NAME) 
            FROM SQ.USES u 
            JOIN SQ.SQUATTER_USES su ON u.ID = su.USE_ID 
            WHERE su.OBJECT_ID IS NOT NULL 
              AND su.OBJECT_ID IN (SELECT OBJECTID FROM SDE_SQ.SQUATTERUSE))
           +
           (SELECT COUNT(u.NAME) 
            FROM SQ.USES u 
            JOIN SQ.SQUATTER_USE_HIS su ON u.ID = su.USE_ID 
            WHERE su.OBJECT_ID IS NOT NULL 
              AND su.OBJECT_ID IN (SELECT OBJECTID FROM SDE_SQ.SQUATTERUSE_HIS))
       ) AS "SUCCESS"
FROM DUAL;
