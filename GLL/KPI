            SELECT COUNT(DISTINCT lp.GLL_NO)
FROM LICENCEANDPERMIT lp
LEFT JOIN LICENCEANDPERMITPOLY poly ON lp.LICENCEANDPERMITPOLYID = poly.LICENCEANDPERMITPOLYID
LEFT JOIN LICENCEANDPERMITLINE line ON lp.LICENCEANDPERMITLINEID = line.LICENCEANDPERMITLINEID
WHERE 
    (lp.TYPE = 'POLYGON' AND NVL(lp.LICENCEANDPERMITPOLYID, 'NULL') != NVL(TO_CHAR(poly.LICENCEANDPERMITPOLYID), 'NULL'))
    OR 
    (lp.TYPE = 'POLYLINE' AND NVL(lp.LICENCEANDPERMITLINEID, 'NULL') != NVL(TO_CHAR(line.LICENCEANDPERMITLINEID), 'NULL'))";